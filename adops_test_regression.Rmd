---
output: html_document
---

**Summary:** The data appears to be generated by a hyperbolic paraboloid function. My best approximation of the function is $C = 10 - 0.4A^2B + 2A - 3B$.

**Exploration and modeling:**
```{r include=FALSE}
library(tidyverse)
knitr::opts_chunk$set(message = FALSE, warning = FALSE)
```

First, I tried plotting the predictor variables against the target.

```{r}
data <- read_csv('./adops_data_regression.csv', col_names = c("A", "B", "C"))

par(mfrow = c(1, 2))
with(data, plot(A, C))
with(data, plot(B, C))
```

One point seems to be an extreme outlier. I also tried plotting the predictors against each other.

```{r}
with(data, plot(A, B))
```

There is no discernable relationship between them. Variable A seems to be right skewed, while B seems to be uniformly distributed.

```{r}
par(mfrow = c(1,2))
hist(data$A)
hist(data$B)
```

I tried fitting a linear model of the form $\hat{C} = b_0 + b_1 A + b_2 B$.

```{r}
m1 <- lm(C ~ A + B, data = data)
summary(m1)
```

This model seems to be a poor fit based on high p-values for all coefficients and the model as a whole. I checked diagnostic plots and found that value 201 is an extreme outlier, as expected.

```{r}
par(mfrow = c(2,2))
plot(m1)
```

I removed the outlier value and refit the model.

```{r}
m2 <- lm(C ~ A + B, data = data[-201,])
summary(m2)
```

This is a better fit, but diagnostics reveal that the residuals are not normally distributed or independent.

```{r}
par(mfrow = c(2,2))
plot(m2)
```

To dig deeper, I created a 3d scatter plot of the three variables.

```{r}
library(plotly)
plot_ly(data[-201,], x = ~A, y = ~B, z = ~C, marker=list(color='blue', size=2)) %>%
  add_markers()
```

The target variable seems to be generated by a hyperbolic paraboloid function. After some trial and error, I fit another model of the form $\hat{C} = b_0 + b_1 A^2  B + b_2 A + b_3 B$.

```{r}
m3 <- lm(C ~ I(A^2*B) + A + B, data = data[-201,])
summary(m3)
```

```{r}
par(mfrow = c(2,2))
plot(m3)
```

While the issues with normality and independence of the residuals have not been eliminated, the residuals have been greatly reduced. Time permitting, it may be possible to refine the model to further reduce the residuals.